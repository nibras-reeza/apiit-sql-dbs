select DOCTOR.DOCTOR_ID,DOCTOR.FIRST_NAME,DOCTOR.LAST_NAME,count(APPOINTMENT_ID) as NUMBER_OF_APPOINTMENTS 
	
	from APPOINTMENT 
	
	inner join DOCTOR on
		DOCTOR.DOCTOR_ID=APPOINTMENT.DOCTOR_ID 
		
where APPOINTMENT_DATE=convert(date,getdate())
group by DOCTOR.DOCTOR_ID,DOCTOR.FIRST_NAME,DOCTOR.LAST_NAME
having count(APPOINTMENT_ID)>3;

/*
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('1',convert(date,getdate()),'18:00:00','PT00000012','DT00000028',null,'ST00000001');
	
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('6',convert(date,getdate()),'18:15:00','PT00000014','DT00000028',null,'ST00000001');
	
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('26',convert(date,getdate()),'18:30:00','PT00000012','DT00000028',null,'ST00000001');
	
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('7',convert(date,getdate()),'18:45:00','PT00000010','DT00000001',null,'ST00000001');
	
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('9',convert(date,getdate()),'19:00:00','PT00000009','DT00000001',null,'ST00000001');
	
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('2',convert(date,getdate()),'19:15:00','PT00000003','DT00000001',null,'ST00000001');
	
insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('36',convert(date,getdate()),'19:30:00','PT00000017','DT00000012',null,'ST00000001');

insert into APPOINTMENT(APPOINTMENT_NUMBER,APPOINTMENT_DATE,APPOINTMENT_TIME,PATIENT_ID,DOCTOR_ID,PAYMENT,SECRETARY)
	values('2',convert(date,getdate()),'21:15:00','PT00000019','DT00000001',null,'ST00000001');
*/